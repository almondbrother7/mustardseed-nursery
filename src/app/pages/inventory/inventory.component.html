<ng-container *ngIf="categories.length; else noData">
  <mat-tab-group [(selectedIndex)]="selectedIndex" (selectedIndexChange)="onTabChange($event)">
    <mat-tab *ngFor="let category of categories">
      <ng-template mat-tab-label>
        <span *ngIf="category.icon">{{ category.icon }}</span> {{ category.label }}
      </ng-template>

      <!-- Category Intro Section -->
      <div class="category-intro" *ngIf="category.tagline">
        <h2>{{ category.tagline }}</h2>
        <p *ngIf="category.description">{{ category.description }}</p>
      </div>

      <!-- Plant Grid -->
      <div class="plant-grid">
        <ng-container *ngIf="plants?.length! > 0">
          <div 
            class="plant-card" 
            *ngFor="let plant of plantsFilteredByCategory"
            (click)="openLightbox(plant)"
          >
            <img [src]="plant.thumbnail" [alt]="plant.name" />
            <div class="plant-info">
              <h3>{{ plant.name }}</h3>
              <p class="price">${{ plant.price }}</p>
            </div>
            <button 
              mat-stroked-button 
              color="primary" 
              class="request-button"
              (click)="requestOrder(plant)">
              Reserve
          </button>
          </div>
      </ng-container>
    </div>

      <!-- Empty State -->
      <div class="no-inventory" *ngIf="plantsFilteredByCategory.length === 0">
        <p>No plants available in this category right now. Please check back soon!</p>
      </div>
    </mat-tab>
  </mat-tab-group>
</ng-container>

<ng-template #noData>
  <p class="no-data-message">No plants found! Please check back later.</p>
</ng-template>

<!-- Shared Lightbox -->
<app-lightbox [categoryChange]="onCategoryChange.bind(this)"></app-lightbox>
